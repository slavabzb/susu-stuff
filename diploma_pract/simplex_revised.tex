\subsection{Обратный сиплекс-метод}
\label{simplex_revised}

Вычислительные этапы обратного симплекс-метода представлены в таблице~\ref{tb:revised}. Вначале каждой итерации полагается, что вектор альтернативных издержек~$\hat{c}_N$ и вектор~$\hat{b}$ текущих значений базисных переменных известны, и представление~$B^{-1}$ доступно. Первым шагом алгоритма является \texttt{CHUZC}, который сканирует (взвешенные) альтернативные издержки, чтобы определить хорошего кандидата~$q$ для ввода в базис. \textit{Колонка поворота}~$\hat{a}_q$ формируется на шаге \texttt{FTRAN}, используя представление~$B^{-1}$.

\begin{table}[]
\centering
\begin{tabularx}{\linewidth}{lX}
\texttt{CHUZC}:                  & Выбрать из~$\hat{c}_N$ хорошего кандидата~$q$ для ввода в базис.                                                \\
\texttt{FTRAN}:                  & Сформировать колонку поворота~$\hat{a}_q=B^{-1}a_q$, где~$a_q$ -- колонка~$q$ матрицы~$A$.       \\
\texttt{CHUZR}:                  & Из отношений~$\hat{b}_i/\hat{a}_{iq}$ определить номер~$p$ строки хорошего кандидата для вывода из базиса. \\
                                 & Положить~$\alpha=\hat{b}_p/\hat{a}_{pq}$.                                                                       \\
                                 & Обновить~$\hat{b}:=\hat{b}-\alpha\hat{a}_q$.                                                                    \\
\texttt{BTRAN}:                  & Сформировать~$\pi^T_p=e^T_pB^{-1}$.                                                                             \\
\texttt{PRICE}:                  & Сформировать строку поворота~$\hat{a}^T_p=\pi^T_pN$.                                                            \\
                                 & Обновить альтернативные издержки~$\hat{c}^T_N:=\hat{c}^T_N-\hat{c}_q\hat{\alpha}^T_p$.                          \\
\multicolumn{2}{l}{\texttt{Если} \{рост в представлении~$B^{-1}$\}, \texttt{тогда}}                                                                                    \\
\multicolumn{2}{l}{\hspace*{1cm}\texttt{INVERT}: Сформировать новое представление~$B^{-1}$.}                                                     \\
\multicolumn{2}{l}{\texttt{иначе}}                                                                                                                                 \\
\multicolumn{2}{l}{\hspace*{1cm}\texttt{UPDATE}: Обновить представление~$B^{-1}$ в соответствии с изменением базиса.}                            \\
\multicolumn{2}{l}{\texttt{конец если}}                                                                                                                           
\end{tabularx}
\caption{Итерация обратного симплекс-метода}
\label{tb:revised}
\end{table}

На шаге \texttt{CHUZR} определяется выводимая из базиса переменная. Индекс~$p$ показывает, в какой строке расположена выводимая переменная, а сама строка именуется \textit{строкой поворота}. Индекс самой переменной обозначается как~$p'$. Как только индексы~$q$ и~$p'$ меняются местами между множествами~$\mathcal{B}$ и~$\mathcal{N}$, говорят, что произошло \textit{изменение базиса}. После этого, правый вектор-столбец~$\hat{b}$ обновляется в соответствии с увеличением~$\alpha=\hat{b}_p/\hat{a}_{pq}$ в~$x_q$.

Перед выполнением следующей операции необходимо получить значения альтернативных издержек и представление новой матрицы~$B^{-1}$. Хотя альтернативные издержки могут быть вычислены и напрямую, используя выражения $$\pi^T_B=c^T_BB^{-1};\mbox{ }\hat{c}^T_N=c^T_N-\pi^T_BN,$$ в вычислительном смысле гораздо эффективнее обновлять их с помощью строки поворота~$\hat{a}^T_p=e^T_pB^{-1}N$ из таблицы стандартного симплекса. Это выполняется в два шага. Сначала, используя представление~$B^{-1}$, на шаге \texttt{BTRAN} формируется вектор~$\pi^T_p=e^T_pB^{-1}$, а затем строится вектор~$\hat{a}^T_p=\pi^T_pN$ значений строки поворота (шаг \texttt{PRICE}). Как только были получены значения альтернативных издержек, шак \texttt{UPDATE} изменяет представление~$B^{-1}$ в соответствии с изменением базиса. Необходимо отметить, что из соображений эффективности и численной стабильности, периодически необходимо находить новое представление~$B^{-1}$ с помощью операции \texttt{INVERT}.

При применении стратегии Devex\cite{Harris1973}, строка поворота, вычисленная для обновления альтернативных издержек, используется также для обновления Devex весов при незначительных вычислительных затратах. Для обновления точных весов в методе наиболее крутого ребра в дополнение к строке поворота требуется дополнительный шаг \texttt{BTRAN} для вычисления~$\hat{a}^T_qB^{-1}$ и шаг \texttt{PRICE} для получения результата матричного умножения этого вектора и матрицы~$N$. Также вычислительно неэффективно инициализировать значения весов наиболее крутого ребра, если начальная базисная матрица не единичная. Как следствие этих дополнительных затрат и поскольку стратегия Devex работает хорошо в плане уменьшения количества итераций, необходимых для решения ЗЛП, эта стратегия обычно используется в эффективных последовательных реализациях обратного симплекс-метода.
