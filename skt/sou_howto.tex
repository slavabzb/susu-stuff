\newpage
\section{Технические особенности верстки: сложные случаи}

В процессе перевода проекта методического пособия из формата MS Word в формат PDF, следует учесть, что язык системы \LaTeX\cite{lvovsky2003} -- компилируемый, а это значит, что перед получением результата необходимо исходный текст, содержащий специальные макрокоманды и определения, передать на предварительную обработку компилятору, который, основываясь на синтаксисе языка и семантике конкретных команд, сгенерирует документ PDF.

Каждое отдельное задание было оформлено как отдельный модуль в виде подраздела -- \texttt{\textbackslash subsection} в терминах \LaTeX. Кроме этого, после каждого подраздела была сформирована ссылка \texttt{\textbackslash label} для того, чтобы на данный раздел можно было ссылаться с помощью команды \texttt{\textbackslash ref}, как показано в примере ниже.
\begin{verbatim}
\subsection{Задание 1}
\label{task_1}
\end{verbatim}

Системы уравнений вида
\begin{eqnarray*}
C_t &=& \alpha + \beta Y_t + \varepsilon_{1_t} \\
Y_t &=& C_t + I_t + G_t \\
I_t &=& \gamma + \delta Y_t + \varepsilon_{2_t}
\end{eqnarray*}
набирались с помощью окружения \texttt{eqnarray}.

\begin{verbatim}
\begin{eqnarray*}
C_t &=& \alpha + \beta Y_t + \varepsilon_{1_t} \\
Y_t &=& C_t + I_t + G_t                        \\
I_t &=& \gamma + \delta Y_t + \varepsilon_{2_t}
\end{eqnarray*}
\end{verbatim}

Важно заметить, что в подобном примере для выравнивания частей уравнения используется знак \&, который позволяет отделить логические части друг от друга. Знак \texttt{*} в названии окружения использовался для отключения нумерации формул.

Подписи, необходимые для комментирования некоторых уравнений, добавляются с помощью специальной комманды \texttt{\textbackslash mbox}. Пример, когда могут потребоваться дополнительные пояснения к уравнениям, приведен ниже.
\begin{eqnarray*}
C_t &=& a_1\mbox{\hspace{10mm}(функция потребления)}; \\
I_t &=& a_2\mbox{\hspace{10mm}(функция инвестиций)};  \\
Y_t &=& C_t+I_t\mbox{\hspace{10mm}(тождество дохода)},
\end{eqnarray*}

Ниже представлен исходный код, формирующий такую систему с комментариями к отдельным уравнениям.

\begin{verbatim}
\begin{eqnarray*}
C_t &=& a_1\mbox{\hspace{10mm}(функция потребления)}; \\
I_t &=& a_2\mbox{\hspace{10mm}(функция инвестиций)};  \\
Y_t &=& C_t+I_t\mbox{\hspace{10mm}(тождество дохода)},
\end{eqnarray*}
\end{verbatim}

Для создания левой открывающей скобки \{, используемой обычно в системах уравнений, подобных
$$
\left\{
\begin{array}{rcl}
y_{1t} &=& a_{12}y_{2t}+b_{11}x_{1t}+\nu_{1t} \\
y_{2_t} &=& a_{21}y_{1t}+b_{22}x_{2t}+\nu_{2t}
\end{array}
\right.,
$$
использовалась специальная пара конструкций \LaTeX \texttt{\textbackslash left} и \texttt{\textbackslash right}.

\begin{verbatim}
\left\{
\begin{array}{rcl}
y_{1t} &=& a_{12}y_{2t}+b_{11}x_{1t}+\nu_{1t} \\
y_{2_t} &=& a_{21}y_{1t}+b_{22}x_{2t}+\nu_{2t}
\end{array}
\right.
\end{verbatim}

Особенностью здесь является закрывающая пара \texttt{\textbackslash right.}, которая не дает вывода на печать, но необходима для закрытия блока.

Для создания нетривиальных таблиц, представляющих некоторые статистические данные, использовались дополнительные пакеты. Рассмотрим пример ниже.

\begin{center}
\begin{tabular}{|r|r|r|r|r|r|r|} \hline
\multicolumn{1}{|m{10mm}|}{Те\-ку\-щий период, $t$} &
\multicolumn{1}{m{20mm}|}{Реальный ВВП, $Y$} &
\multicolumn{1}{m{20mm}|}{Доля импорта в ВВП, $M$} &
\multicolumn{1}{m{25mm}|}{Общее число прошений об освобождении от таможенных пошлин, $N$} & 
\multicolumn{1}{m{35mm}|}{Число удовлетворенных прошений об освобождении от таможенных пошлин, $S$} &
\multicolumn{1}{m{15mm}|}{Фик\-тив\-ная переменная, $F$} &
\multicolumn{1}{m{25mm}|}{Реальный объем чистого экспорта, $X$} \\ \hline
1 & 1 398,5 & 0,129471 & 900 & 800 & 1 & 185,6 \\ \hline 
\end{tabular} 
\end{center}

Для формирования такой таблицы необходимо задействовать специализированный пакет \texttt{multirow}, позволяющий объединять колонки и строки таблиц. Исходный код таблицы представлен ниже.

\begin{verbatim}
\begin{center}
\begin{tabular}{|r|r|r|r|r|r|r|} \hline
\multicolumn{1}{|m{10mm}|}{Текущий период, $t$}    &
\multicolumn{1}{m{20mm}|}{Реальный ВВП, $Y$}       &
\multicolumn{1}{m{20mm}|}{Доля импорта в ВВП, $M$} &
\multicolumn{1}{m{25mm}|}{Общее число прошений...} & 
\multicolumn{1}{m{35mm}|}{Число удовлетворенных...}&
\multicolumn{1}{m{15mm}|}{Фиктивная переменная...} &
\multicolumn{1}{m{25mm}|}{Реальный объем чистого} \\ 
\end{tabular} 
\end{center}
\end{verbatim}

Важно обратить внимание на достигнутый эффект выравнивания. Шапка таблицы выровнена по левому краю, в то время как тело -- по правому.

И наконец, переходим к наиболее сложным случаям верстки выражений с участием матриц. Рассмотрим пример.

$$
\begin{array}{c}
\vphantom{W_{t-1}} \\
\displaystyle{\Pi_1^{**}=\frac{-1}{\beta_{12}\beta_{21}}}
\end{array}
\begin{array}{cccc}
\begin{array}{c}
\vphantom{S_t} \\
\left(
\vphantom{
\begin{array}{c}
-\beta_{12} \\
\gamma_{22} \\
\beta_{21}
\end{array}
}
\right.
\end{array}
&
\begin{array}{cc}
S_t & W_{t-1} \\
\gamma_{11}(1-\beta_{23}\beta_{32}) & \gamma_{13}(1-\beta_{23}\beta_{32}) \\
-\beta_{21}\gamma_{11} & -\beta_{21}\gamma_{13}-\beta_{23}\gamma_{33} \\
\beta_{21}\beta_{32}\gamma_{11} & \beta_{21}\beta_{32}\gamma_{13}+\gamma_{33}(1-\beta_{12}\beta_{21})
\end{array}
&
\begin{array}{c}
\vphantom{W_{t-1}} \\
\left.
\vphantom{
\begin{array}{c}
\beta_{12} \\
\gamma_{24} \\
\beta_1
\end{array}
}
\right)
\end{array}
&
\begin{array}{c}
\vphantom{W_{t-1}} \\
\begin{array}{c}
P_t \\
W_t \\
N_t
\end{array}
\end{array}
\end{array}
$$

В приведенном примере существует несколько особенностей.
\begin{enumerate}
\item Перед матрицей, записанной в скобках, находится коэффициент (дробь), который должен быть выровнен вертикально по центру.
\item Над матрицей, записанной в скобках, и после нее размещаются поясняющие индексы.
\item Скобки должны ограничивать только нужную часть, на наползая на индексы.
\end{enumerate}

Подобное архитектурное решение можно достичь, если произвести условную декомпозицию примера. Например, можно считать, что все выражение -- это совокупность массивов. Все, что расположено до открывающей скобки -- это массив размера $2\times 1$, причем дробь расположена в нижней ячейке. Далее, следует еще один массив $2\times 1$, в верхней ячейке которого -- массив $1\times 2$ (верхние индексы), а в нижней ячейке -- массив  $1\times 4$, в котором в первой колонке -- открывающая скобка, во второй -- массив $3\times 1$ (первая колонка матрицы в скобках), в третьей также массив $3\times 1$ (вторая колонка матрицы в скобках), и наконец, в последней -- закрывающая скобка. Завершает композицию массив $2\times 1$, нижняя ячейка которого -- подмассив $3\times 1$ -- индесы, записанные справа.

Здесь для создание необходимых пустот были использованы специальные инструкции \LaTeX~-- фантомы -- \texttt{\textbackslash vphantom} и \texttt{\textbackslash phantom}. Фантомы позволяют получить непечатаемый символ, занимающий по ширине или высоте такое же пространство, как если бы символ присутствовал бы на печати.

Рассмотренные примеры -- не единственные интересные случае, возникающие при переводе методических указаний из формата MS Word в формат PDF.
