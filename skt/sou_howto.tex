\section{Реализация}

Рассмотрим программную реализацию технического индикатора. В качестве языка программирования был выбран Python.

Python -- высокоуровневый язык программирования общего назначения, ориентированный на повышение производительности разработчика и читаемости кода. Синтаксис ядра Python минималистичен. В то же время стандартная библиотека включает большой объём полезных функций.

Python поддерживает несколько парадигм программирования, в том числе структурное, объектно-ориентированное, функциональное, императивное и аспектно-ориентированное. Основные архитектурные черты -- динамическая типизация, автоматическое управление памятью, полная интроспекция, механизм обработки исключений, поддержка многопоточных вычислений и удобные высокоуровневые структуры данных. Код в Python организовывается в функции и классы, которые могут объединяться в модули (они в свою очередь могут быть объединены в пакеты).

Эталонной реализацией Python является интерпретатор CPython, поддерживающий большинство активно используемых платформ. Он распространяется под свободной лицензией Python Software Foundation License, позволяющей использовать его без ограничений в любых приложениях, включая проприетарные. Есть реализации интерпретаторов для JVM (с возможностью компиляции), MSIL (с возможностью компиляции), LLVM и других. Проект PyPy предлагает реализацию Python на самом Python, что уменьшает затраты на изменения языка и постановку экспериментов над новыми возможностями.

Python -- активно развивающийся язык программирования, новые версии (с добавлением/изменением языковых свойств) выходят примерно раз в два с половиной года. Вследствие этого и некоторых других причин на Python отсутствуют стандарт ANSI, ISO или другие официальные стандарты, их роль выполняет CPython.

Как и в большинстве случаев, управляющий поток начинает выполнение со стандартной конструкции с выводом строки приветствия.

\lstinputlisting[firstline=90,lastline=91,firstnumber=90]{i/script.py}

Далее, подключаются необходимые для работы модули:

\begin{itemize}
\item\textbf{sys} -- модуль предоставляет доступ к некоторым переменным и функциям, используемым интерпретатором;
\item\textbf{argparse} -- используется для написания дружественных интерфейсов командной строки;
\item\textbf{logging} -- модуль определяет функции и классы, реализующие расширяемую систему логирования для приложений и библиотек.
\end{itemize}

\lstinputlisting[firstline=93,lastline=95,firstnumber=93]{i/script.py}

Производится настройка аргументов командной строки для конфигурирования параметров приложения.

\lstinputlisting[firstline=97,lastline=106,firstnumber=97]{i/script.py}

Также настраивается система логирования для вывода сообщений в файл.

\lstinputlisting[firstline=111,lastline=117,firstnumber=111]{i/script.py}

При необходимости, вывод перенаправляется либо в файл, либо в стандартный поток вывода.

\lstinputlisting[firstline=119,lastline=122,firstnumber=119]{i/script.py}

Происходит конфигурирование периода, за который необходимо получить информацию.

\lstinputlisting[firstline=124,lastline=130,firstnumber=124]{i/script.py}

На этом этапе логика работы приложения делится. Либо данные читаются из файла, если в параметрах командной строки был задан путь до файла. Либо данные скачиваются из сети Интернет, если был задан адрес.

\lstinputlisting[firstline=134,lastline=148,firstnumber=134]{i/script.py}

Происходит загрузка данных из источника, вывод результатов обработки в приемник и выдача стратегии MFI по требованию.

\lstinputlisting[firstline=150,lastline=157,firstnumber=150]{i/script.py}

Все ошибки приложение обратывает с помощью механизма исключений с выводом причины в файл.

\lstinputlisting[firstline=159,lastline=162,firstnumber=159]{i/script.py}

Рассмотрим подробнее механизм загрузки данных. Функция принимает на вход адрес с данными и выводит информационное сообщение.

\lstinputlisting[firstline=3,lastline=4,firstnumber=3]{i/script.py}

Производится подключение небходимых для работы функций и классов.

\begin{itemize}
\item\textbf{urllib2} -- модуль определяет функции и классы, которые предназначены для окрытия веб страниц;
\item\textbf{csv} -- модуль реализует классы для чтения и записи табличных данных в формате CSV;
\item\textbf{time} -- модуль для работы с датой и временем.
\end{itemize}

\lstinputlisting[firstline=6,lastline=7,firstnumber=6]{i/script.py}

\lstinputlisting[firstline=18,lastline=18,firstnumber=18]{i/script.py}

Происходит окрытие указанного адреса и чтение данных.

\lstinputlisting[firstline=9,lastline=9,firstnumber=9]{i/script.py}

Данные читаются построчно, формируя заданную структуру ответа, которая возвращается как результат работы функции.

\lstinputlisting[firstline=20,lastline=30,firstnumber=20]{i/script.py}

Функция обработки данных принимает на вход сформированные данные и период обработки.

\lstinputlisting[firstline=73,lastline=74,firstnumber=73]{i/script.py}

Происходит подсчет средних значений показателей за рассмотриваемый период, и результат обработки возвращается.

\lstinputlisting[firstline=75,lastline=88,firstnumber=75]{i/script.py}

Функция получения MFI стратегии использует показание технического индикатора для формирования своего результата.

\lstinputlisting[firstline=66,lastline=71,firstnumber=66]{i/script.py}

Функция расчета индикатора нормирует значение денежного отношения.

\lstinputlisting[firstline=63,lastline=64,firstnumber=63]{i/script.py}

Денежное отношение -- это отношение положительного денежного потока за период к отрицательному денежному потоку за тот же период.

\lstinputlisting[firstline=60,lastline=62,firstnumber=60]{i/script.py}

Функции получения полного положительного/отрицательного денежного потока используют методы получения денежного потока за период.

\lstinputlisting[firstline=48,lastline=58,firstnumber=48]{i/script.py}

Методы получения знакового денежного потока оперируют понятием типичной цены.

\lstinputlisting[firstline=38,lastline=46,firstnumber=38]{i/script.py}

Денежный поток -- это произведение типичной цены на объем продаж.

\lstinputlisting[firstline=35,lastline=36,firstnumber=35]{i/script.py}

Типичная цена, в свою очередь, рассчитывается как среднее среди максимальной, минимальной и ценой закрытия.

\lstinputlisting[firstline=32,lastline=33,firstnumber=32]{i/script.py}

Таким образом, мы рассмотрели программные особенности реализации технического индикатора "денежный поток".
